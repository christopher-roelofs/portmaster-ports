<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://getbootstrap.com/docs/5.3/assets/css/docs.css" rel="stylesheet">
    <title>Porter Profile</title>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
    <!----  <style>
        .mb-3 {
            float: left;
            width: 33%;
        }
    </style>
-->
</head>

<body class="p-3 m-0 border-0 bd-example m-0 border-0">

    <h1>
        Porter Profile
    </h1>
    <br>
    <select id="porters" class="form-select" aria-label="Default select example" onchange="selectPorter()">
        <option selected>Add New Porter</option>
    </select>
    <br>

    <form>
        <div class="mb-3">
            <label for="name" class="form-label">Name</label>
            <input required type="text" class="form-control" id="name">
        </div>
        <div class="mb-3">
            <label for="social" class="form-label">Social Media Link</label>
            <input type="text" class="form-control" id="social">
        </div>
        <div class="mb-3">
            <label for="support" class="form-label">Support Page</label>
            <input type="text" class="form-control" id="support">
        </div>
        <div class="mb-3">
            <label for="webpage" class="form-label">Personal Webpage or Github</label>
            <input type="text" class="form-control" id="webpage">
        </div>
        <div class="mb-3">
            <label for="image" class="form-label">Profile Image URL</label>
            <input type="text" class="form-control" id="image">
        </div>
        <button type="submit" onclick="updateProfile()" class="btn btn-primary">Submit</button>
    </form>
    
    <br>
    <br>
    <br>
    <div id="json">

    </div>
    <script>
        porters = null;
        var selectElement = document.getElementById("porters");
        var nameElement = document.getElementById("name");
        var socialElement = document.getElementById("social");
        var supportElement = document.getElementById("support");
        var webpageElement = document.getElementById("webpage");
        var imageElement = document.getElementById("image");

        function selectPorter() {
            var porter = selectElement.value;
            if (porter != "Add New Porter") {
                nameElement.value = porters[porter].name;
                socialElement.value = porters[porter].social
                supportElement.value = porters[porter].support
                webpageElement.value = porters[porter].webpage
                imageElement.value = porters[porter].image
                nameElement.readOnly = true;
            }
            else {
                nameElement.value = "";
                socialElement.value = "";
                supportElement.value = "";
                webpageElement.value = "";
                imageElement.value = "";
                nameElement.readOnly = false;
        }
    }

        function updateProfile() {
            var name = selectElement.value;
            porters[name].name = name;
            porters[name].social = socialElement.value;
            porters[name].support = supportElement.value;
            porters[name].webpage = webpageElement.value;
            porters[name].image = imageElement.value;
            document.getElementById("json").textContent = JSON.stringify(porters);
        }

        async function loadPorters() {
            try {
                var response = await fetch('https://raw.githubusercontent.com/christopher-roelofs/portmaster-ports/main/porters.json'); // Replace 'YOUR_JSON_URL_HERE' with the actual URL of your JSON data.
                if (!response.ok) {
                    throw new Error('Network response was not ok.');
                }
                porters = await response.json();
            } catch (error) {
                console.error('Error fetching JSON data:', error);
            }


            for (var key of Object.keys(porters)) {
                var opt = document.createElement('option');
                opt.value = key;
                opt.innerHTML = key;
                selectElement.appendChild(opt);
            };
        }

        // Call the initial fetchDataAndDisplayCards function when the page is loaded
        window.onload = function () {
            loadPorters();

        };
    </script>
</body>

</html>